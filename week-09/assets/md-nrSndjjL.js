import{f as H,o as l,e as n,g as t,n as O,t as m,ad as r,T as b,j as d,k as W,F as z,aj as F,r as w,z as k,b as A,w as G,d as J,v as K,x as Q}from"./modules/vue-EkOm0DBg.js";import{u as B,f as U}from"./slidev/context-Bhxie35i.js";import{_ as Y}from"./index-dGu4t6fW.js";import{_ as Z}from"./interactive-D1PIzf3L.js";import"./modules/shiki-CIKF_8I9.js";const X={class:"rt"},tt={class:"rt-controls"},st=["disabled"],at={class:"rt-stats"},et={key:0},lt={class:"rt-saved"},nt={class:"rt-svg-container"},rt=["viewBox"],ot=["x1","y1","x2","y2"],it=["cx","cy"],ut=["x","y"],ct=["x","y"],mt={key:0,class:"rt-memo"},pt=H({__name:"RecursionTree",props:{n:{default:5}},setup(T){B();const M=T;let g=0;function x(s,a){if(s<0)return null;const e={id:g++,value:s,x:0,y:a*56,left:null,right:null,result:s<=1?s:-1,depth:a};return s>=2&&(e.left=x(s-1,a+1),e.right=x(s-2,a+1),e.left&&e.right&&e.left.result>=0&&e.right.result>=0&&(e.result=e.left.result+e.right.result)),e}function o(s,a){s&&(o(s.left,a),s.x=a.val,a.val+=52,o(s.right,a))}function h(s,a){s&&(a.push(s),h(s.left,a),h(s.right,a))}function N(s,a){s&&(s.left&&(a.push({from:s,to:s.left}),N(s.left,a)),s.right&&(a.push({from:s,to:s.right}),N(s.right,a)))}function C(s,a){s&&(C(s.left,a),C(s.right,a),a.push(s.id))}g=0;const _=x(M.n,0);o(_,{val:20});const i=[];h(_,i);const $=[];N(_,$);const y=[];C(_,y);const j=k(()=>{const s=new Map;for(const a of i)s.set(a.value,(s.get(a.value)||0)+1);return s}),V=k(()=>{const s=new Set;for(const[a,e]of j.value)e>1&&s.add(a);return s}),u=w(!1),c=w(new Set),v=w(0),p=w(new Map),E=k(()=>Math.max(...i.map(s=>s.x))+40),I=k(()=>Math.max(...i.map(s=>s.y))+50);function L(){if(v.value>=y.length)return;const s=y[v.value];c.value.add(s);const a=i.find(e=>e.id===s);u.value&&(p.value.has(a.value)||p.value.set(a.value,a.result)),v.value++}function S(){c.value=new Set,v.value=0,p.value=new Map}function P(){u.value=!u.value,S()}const R=i.length,q=new Set(i.map(s=>s.value)).size;function D(s){const a=["rt-node"];return c.value.has(s.id)&&a.push("evaluated"),V.value.has(s.value)&&a.push("duplicate"),u.value&&p.value.has(s.value)&&!c.value.has(s.id)&&a.push("memo-hit"),a.join(" ")}return(s,a)=>(l(),n("div",X,[t("div",tt,[t("button",{class:O(["rt-btn",{"rt-active":u.value}]),onClick:P},m(u.value?"メモ化 ON":"メモ化 OFF"),3),t("button",{class:"rt-btn",onClick:L,disabled:v.value>=y.length},"次のステップ",8,st),t("button",{class:"rt-btn rt-reset",onClick:S},"リセット")]),t("div",at,[t("span",null,[a[0]||(a[0]=r("再帰呼出し: ",-1)),t("strong",null,m(b(R))+"回",1)]),u.value?(l(),n("span",et,[a[1]||(a[1]=r(" → メモ化で ",-1)),t("strong",lt,m(b(q))+"回",1),a[2]||(a[2]=r(" に削減",-1))])):d("v-if",!0)]),t("div",nt,[(l(),n("svg",{viewBox:`0 0 ${E.value} ${I.value}`,style:W({width:`${Math.min(E.value,600)}px`})},[d(" Edges "),(l(),n(z,null,F($,(e,f)=>t("line",{key:`e-${f}`,x1:e.from.x,y1:e.from.y+16,x2:e.to.x,y2:e.to.y-16,class:O(["rt-edge",{"rt-edge-eval":c.value.has(e.from.id)&&c.value.has(e.to.id)}])},null,10,ot)),64)),d(" Nodes "),(l(),n(z,null,F(i,e=>t("g",{key:e.id,class:O(D(e))},[t("circle",{cx:e.x,cy:e.y,r:"18"},null,8,it),t("text",{x:e.x,y:e.y+1,"text-anchor":"middle","dominant-baseline":"middle","font-size":"12","font-weight":"700"}," F("+m(e.value)+") ",9,ut),c.value.has(e.id)?(l(),n("text",{key:0,x:e.x,y:e.y+30,"text-anchor":"middle","font-size":"11","font-weight":"600",fill:"var(--dsa-green)"}," = "+m(e.result),9,ct)):d("v-if",!0)],2)),64))],12,rt))]),u.value&&p.value.size>0?(l(),n("div",mt,[a[3]||(a[3]=t("span",{class:"rt-memo-label"},"メモ:",-1)),(l(!0),n(z,null,F([...p.value].sort((e,f)=>e[0]-f[0]),([e,f])=>(l(),n("span",{key:e,class:"rt-memo-entry"}," F("+m(e)+")="+m(f),1))),128))])):d("v-if",!0)]))}}),ht=Y(pt,[["__scopeId","data-v-d00f992f"]]),yt={__name:"slides.md__slidev_14",setup(T){const{$clicksContext:M,$frontmatter:g}=B();return M.setup(),(x,o)=>{const h=ht;return l(),A(Z,K(Q(b(U)(b(g),13))),{default:G(()=>[o[0]||(o[0]=t("h2",null,"再帰木で理解するメモ化の効果",-1)),J(h),o[1]||(o[1]=t("ul",null,[t("li",null,[t("span",{class:"katex"},[t("span",{class:"katex-mathml"},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("semantics",null,[t("mrow",null,[t("mi",null,"F"),t("mo",{stretchy:"false"},"("),t("mn",null,"5"),t("mo",{stretchy:"false"},")")]),t("annotation",{encoding:"application/x-tex"},"F(5)")])])]),t("span",{class:"katex-html","aria-hidden":"true"},[t("span",{class:"base"},[t("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),t("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"F"),t("span",{class:"mopen"},"("),t("span",{class:"mord"},"5"),t("span",{class:"mclose"},")")])])]),r(" の再帰木を見てみましょう．同じ部分問題（オレンジの点線）が何度も計算されている")]),t("li",null,[t("strong",null,"メモ化ON"),r("にすると，一度計算した結果（紫）を再利用 → 呼び出し回数が"),t("strong",null,"15回→9回"),r("に激減")]),t("li",null,[r("これが "),t("span",{class:"katex"},[t("span",{class:"katex-mathml"},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("semantics",null,[t("mrow",null,[t("mi",{mathvariant:"normal"},"O"),t("mo",{stretchy:"false"},"("),t("msup",null,[t("mn",null,"2"),t("mi",null,"N")]),t("mo",{stretchy:"false"},")")]),t("annotation",{encoding:"application/x-tex"},"\\mathrm{O}(2^N)")])])]),t("span",{class:"katex-html","aria-hidden":"true"},[t("span",{class:"base"},[t("span",{class:"strut",style:{height:"1.0913em","vertical-align":"-0.25em"}}),t("span",{class:"mord mathrm"},"O"),t("span",{class:"mopen"},"("),t("span",{class:"mord"},[t("span",{class:"mord"},"2"),t("span",{class:"msupsub"},[t("span",{class:"vlist-t"},[t("span",{class:"vlist-r"},[t("span",{class:"vlist",style:{height:"0.8413em"}},[t("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[t("span",{class:"pstrut",style:{height:"2.7em"}}),t("span",{class:"sizing reset-size6 size3 mtight"},[t("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.10903em"}},"N")])])])])])])]),t("span",{class:"mclose"},")")])])]),r(" → "),t("span",{class:"katex"},[t("span",{class:"katex-mathml"},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("semantics",null,[t("mrow",null,[t("mi",{mathvariant:"normal"},"O"),t("mo",{stretchy:"false"},"("),t("mi",null,"N"),t("mo",{stretchy:"false"},")")]),t("annotation",{encoding:"application/x-tex"},"\\mathrm{O}(N)")])])]),t("span",{class:"katex-html","aria-hidden":"true"},[t("span",{class:"base"},[t("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),t("span",{class:"mord mathrm"},"O"),t("span",{class:"mopen"},"("),t("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N"),t("span",{class:"mclose"},")")])])]),r(" の改善の正体 ― 重複する枝がすべて刈り取られる")])],-1))]),_:1},16)}}};export{yt as default};
