import{f as U,r as x,K as W,o as n,e as r,g as t,ad as u,af as A,aL as G,F as w,aj as k,t as v,n as O,j as _,k as J,z as o,b as Q,w as Y,d as Z,v as X,x as tt,T as B}from"./modules/vue-C0dYhuKl.js";import{u as V,f as st}from"./slidev/context-CUpcAaFv.js";import{_ as at}from"./index-C0hr6rby.js";import{_ as et}from"./interactive-C_F3wqou.js";import"./modules/shiki-DQdB7QXP.js";const lt={class:"rt"},nt={class:"rt-controls"},rt={class:"rt-n-label"},ot=["value"],ut=["disabled"],it={class:"rt-stats"},ct={key:0},mt={class:"rt-saved"},vt={class:"rt-svg-container"},pt=["viewBox"],ht=["x1","y1","x2","y2"],dt=["cx","cy"],ft=["x","y"],gt=["x","y"],xt={key:0,class:"rt-memo"},_t=U({__name:"RecursionTree",props:{n:{default:5}},setup(F){V();const h=x(F.n);function y(s,a,e){if(s<0)return null;const l={id:e.val++,value:s,x:0,y:a*56,left:null,right:null,result:s<=1?s:-1,depth:a};return s>=2&&(l.left=y(s-1,a+1,e),l.right=y(s-2,a+1,e),l.left&&l.right&&l.left.result>=0&&l.right.result>=0&&(l.result=l.left.result+l.right.result)),l}function c(s,a){s&&(c(s.left,a),s.x=a.val,a.val+=52,c(s.right,a))}function f(s,a){s&&(a.push(s),f(s.left,a),f(s.right,a))}function b(s,a){s&&(s.left&&(a.push({from:s,to:s.left}),b(s.left,a)),s.right&&(a.push({from:s,to:s.right}),b(s.right,a)))}function M(s,a){s&&(M(s.left,a),M(s.right,a),a.push(s.id))}const N=o(()=>{const s={val:0},a=y(Math.max(0,h.value),0,s);c(a,{val:20});const l=[];f(a,l);const $=[];b(a,$);const E=[];return M(a,E),{tree:a,nodes:l,edges:$,order:E}}),i=o(()=>N.value.nodes),L=o(()=>N.value.edges),C=o(()=>N.value.order),j=o(()=>{const s=new Map;for(const a of i.value)s.set(a.value,(s.get(a.value)||0)+1);return s}),D=o(()=>{const s=new Set;for(const[a,e]of j.value)e>1&&s.add(a);return s}),m=x(!1),p=x(new Set),g=x(0),d=x(new Map),S=o(()=>i.value.length>0?Math.max(...i.value.map(s=>s.x))+40:100),I=o(()=>i.value.length>0?Math.max(...i.value.map(s=>s.y))+50:100);function P(){if(g.value>=C.value.length)return;const s=C.value[g.value];p.value.add(s);const a=i.value.find(e=>e.id===s);m.value&&(d.value.has(a.value)||d.value.set(a.value,a.result)),g.value++}function z(){p.value=new Set,g.value=0,d.value=new Map}function R(){m.value=!m.value,z()}W(h,z);const q=o(()=>i.value.length),H=o(()=>new Set(i.value.map(s=>s.value)).size);function K(s){const a=["rt-node"];return p.value.has(s.id)&&a.push("evaluated"),D.value.has(s.value)&&a.push("duplicate"),m.value&&d.value.has(s.value)&&!p.value.has(s.id)&&a.push("memo-hit"),a.join(" ")}return(s,a)=>(n(),r("div",lt,[t("div",nt,[t("label",rt,[a[1]||(a[1]=u(" n = ",-1)),A(t("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>h.value=e),class:"rt-n-select"},[(n(),r(w,null,k([2,3,4,5,6,7],e=>t("option",{key:e,value:e},v(e),9,ot)),64))],512),[[G,h.value,void 0,{number:!0}]])]),t("button",{class:O(["rt-btn",{"rt-active":m.value}]),onClick:R},v(m.value?"メモ化 ON":"メモ化 OFF"),3),t("button",{class:"rt-btn",onClick:P,disabled:g.value>=C.value.length},"次のステップ",8,ut),t("button",{class:"rt-btn rt-reset",onClick:z},"リセット")]),t("div",it,[t("span",null,[a[2]||(a[2]=u("再帰呼出し: ",-1)),t("strong",null,v(q.value)+"回",1)]),m.value?(n(),r("span",ct,[a[3]||(a[3]=u(" → メモ化で ",-1)),t("strong",mt,v(H.value)+"回",1),a[4]||(a[4]=u(" に削減",-1))])):_("v-if",!0)]),t("div",vt,[(n(),r("svg",{viewBox:`0 0 ${S.value} ${I.value}`,style:J({width:`${Math.min(S.value,600)}px`})},[_(" Edges "),(n(!0),r(w,null,k(L.value,(e,l)=>(n(),r("line",{key:`e-${l}`,x1:e.from.x,y1:e.from.y+16,x2:e.to.x,y2:e.to.y-16,class:O(["rt-edge",{"rt-edge-eval":p.value.has(e.from.id)&&p.value.has(e.to.id)}])},null,10,ht))),128)),_(" Nodes "),(n(!0),r(w,null,k(i.value,e=>(n(),r("g",{key:e.id,class:O(K(e))},[t("circle",{cx:e.x,cy:e.y,r:"18"},null,8,dt),t("text",{x:e.x,y:e.y+1,"text-anchor":"middle","dominant-baseline":"middle","font-size":"12","font-weight":"700"}," F("+v(e.value)+") ",9,ft),p.value.has(e.id)?(n(),r("text",{key:0,x:e.x,y:e.y+30,"text-anchor":"middle","font-size":"11","font-weight":"600",fill:"var(--dsa-green)"}," = "+v(e.result),9,gt)):_("v-if",!0)],2))),128))],12,pt))]),m.value&&d.value.size>0?(n(),r("div",xt,[a[5]||(a[5]=t("span",{class:"rt-memo-label"},"メモ:",-1)),(n(!0),r(w,null,k([...d.value].sort((e,l)=>e[0]-l[0]),([e,l])=>(n(),r("span",{key:e,class:"rt-memo-entry"}," F("+v(e)+")="+v(l),1))),128))])):_("v-if",!0)]))}}),yt=at(_t,[["__scopeId","data-v-ad23a821"]]),Ct={__name:"slides.md__slidev_14",setup(F){const{$clicksContext:T,$frontmatter:h}=V();return T.setup(),(y,c)=>{const f=yt;return n(),Q(et,X(tt(B(st)(B(h),13))),{default:Y(()=>[c[0]||(c[0]=t("h2",null,"再帰木で理解するメモ化の効果",-1)),Z(f),c[1]||(c[1]=t("ul",null,[t("li",null,[t("span",{class:"katex"},[t("span",{class:"katex-mathml"},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("semantics",null,[t("mrow",null,[t("mi",null,"F"),t("mo",{stretchy:"false"},"("),t("mn",null,"5"),t("mo",{stretchy:"false"},")")]),t("annotation",{encoding:"application/x-tex"},"F(5)")])])]),t("span",{class:"katex-html","aria-hidden":"true"},[t("span",{class:"base"},[t("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),t("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"F"),t("span",{class:"mopen"},"("),t("span",{class:"mord"},"5"),t("span",{class:"mclose"},")")])])]),u(" の再帰木を見てみましょう．同じ部分問題（オレンジの点線）が何度も計算されている")]),t("li",null,[t("strong",null,"メモ化ON"),u("にすると，一度計算した結果（紫）を再利用 → 呼び出し回数が"),t("strong",null,"15回→9回"),u("に激減")]),t("li",null,[u("これが "),t("span",{class:"katex"},[t("span",{class:"katex-mathml"},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("semantics",null,[t("mrow",null,[t("mi",{mathvariant:"normal"},"O"),t("mo",{stretchy:"false"},"("),t("msup",null,[t("mn",null,"2"),t("mi",null,"N")]),t("mo",{stretchy:"false"},")")]),t("annotation",{encoding:"application/x-tex"},"\\mathrm{O}(2^N)")])])]),t("span",{class:"katex-html","aria-hidden":"true"},[t("span",{class:"base"},[t("span",{class:"strut",style:{height:"1.0913em","vertical-align":"-0.25em"}}),t("span",{class:"mord mathrm"},"O"),t("span",{class:"mopen"},"("),t("span",{class:"mord"},[t("span",{class:"mord"},"2"),t("span",{class:"msupsub"},[t("span",{class:"vlist-t"},[t("span",{class:"vlist-r"},[t("span",{class:"vlist",style:{height:"0.8413em"}},[t("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[t("span",{class:"pstrut",style:{height:"2.7em"}}),t("span",{class:"sizing reset-size6 size3 mtight"},[t("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.10903em"}},"N")])])])])])])]),t("span",{class:"mclose"},")")])])]),u(" → "),t("span",{class:"katex"},[t("span",{class:"katex-mathml"},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("semantics",null,[t("mrow",null,[t("mi",{mathvariant:"normal"},"O"),t("mo",{stretchy:"false"},"("),t("mi",null,"N"),t("mo",{stretchy:"false"},")")]),t("annotation",{encoding:"application/x-tex"},"\\mathrm{O}(N)")])])]),t("span",{class:"katex-html","aria-hidden":"true"},[t("span",{class:"base"},[t("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),t("span",{class:"mord mathrm"},"O"),t("span",{class:"mopen"},"("),t("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N"),t("span",{class:"mclose"},")")])])]),u(" の改善の正体 ― 重複する枝がすべて刈り取られる")])],-1))]),_:1},16)}}};export{Ct as default};
