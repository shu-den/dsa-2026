import{f as H,o as r,e as o,g as t,n as C,t as h,ad as i,T as b,j as g,k as W,F as O,aj as z,r as w,z as k,b as A,w as G,d as J,v as K,x as Q}from"./modules/vue-EkOm0DBg.js";import{u as S,f as U}from"./slidev/context-Do5j5iSJ.js";import{_ as Y}from"./index-K15CbkxN.js";import{_ as Z}from"./interactive-DRZhOMQ9.js";import"./modules/shiki-CIKF_8I9.js";const X={class:"rt"},tt={class:"rt-controls"},st=["disabled"],at={class:"rt-stats"},et={key:0},lt={class:"rt-saved"},nt={class:"rt-svg-container"},rt=["viewBox"],ot=["x1","y1","x2","y2"],it=["cx","cy"],ut=["x","y"],ct=["x","y"],mt={key:0,class:"rt-memo"},ht=H({__name:"RecursionTree",props:{n:{default:5}},setup(F){S();const M=F;function v(s,a,e){if(s<0)return null;const l={id:e.val++,value:s,x:0,y:a*56,left:null,right:null,result:s<=1?s:-1,depth:a};return s>=2&&(l.left=v(s-1,a+1,e),l.right=v(s-2,a+1,e),l.left&&l.right&&l.left.result>=0&&l.right.result>=0&&(l.result=l.left.result+l.right.result)),l}function x(s,a){s&&(x(s.left,a),s.x=a.val,a.val+=52,x(s.right,a))}function u(s,a){s&&(a.push(s),u(s.left,a),u(s.right,a))}function f(s,a){s&&(s.left&&(a.push({from:s,to:s.left}),f(s.left,a)),s.right&&(a.push({from:s,to:s.right}),f(s.right,a)))}function N(s,a){s&&(N(s.left,a),N(s.right,a),a.push(s.id))}const B={val:0},_=v(Math.max(0,M.n),0,B);x(_,{val:20});const n=[];u(_,n);const T=[];f(_,T);const y=[];N(_,y);const j=k(()=>{const s=new Map;for(const a of n)s.set(a.value,(s.get(a.value)||0)+1);return s}),V=k(()=>{const s=new Set;for(const[a,e]of j.value)e>1&&s.add(a);return s}),c=w(!1),m=w(new Set),d=w(0),p=w(new Map),$=k(()=>n.length>0?Math.max(...n.map(s=>s.x))+40:100),L=k(()=>n.length>0?Math.max(...n.map(s=>s.y))+50:100);function I(){if(d.value>=y.length)return;const s=y[d.value];m.value.add(s);const a=n.find(e=>e.id===s);c.value&&(p.value.has(a.value)||p.value.set(a.value,a.result)),d.value++}function E(){m.value=new Set,d.value=0,p.value=new Map}function P(){c.value=!c.value,E()}const R=n.length,q=new Set(n.map(s=>s.value)).size;function D(s){const a=["rt-node"];return m.value.has(s.id)&&a.push("evaluated"),V.value.has(s.value)&&a.push("duplicate"),c.value&&p.value.has(s.value)&&!m.value.has(s.id)&&a.push("memo-hit"),a.join(" ")}return(s,a)=>(r(),o("div",X,[t("div",tt,[t("button",{class:C(["rt-btn",{"rt-active":c.value}]),onClick:P},h(c.value?"メモ化 ON":"メモ化 OFF"),3),t("button",{class:"rt-btn",onClick:I,disabled:d.value>=y.length},"次のステップ",8,st),t("button",{class:"rt-btn rt-reset",onClick:E},"リセット")]),t("div",at,[t("span",null,[a[0]||(a[0]=i("再帰呼出し: ",-1)),t("strong",null,h(b(R))+"回",1)]),c.value?(r(),o("span",et,[a[1]||(a[1]=i(" → メモ化で ",-1)),t("strong",lt,h(b(q))+"回",1),a[2]||(a[2]=i(" に削減",-1))])):g("v-if",!0)]),t("div",nt,[(r(),o("svg",{viewBox:`0 0 ${$.value} ${L.value}`,style:W({width:`${Math.min($.value,600)}px`})},[g(" Edges "),(r(),o(O,null,z(T,(e,l)=>t("line",{key:`e-${l}`,x1:e.from.x,y1:e.from.y+16,x2:e.to.x,y2:e.to.y-16,class:C(["rt-edge",{"rt-edge-eval":m.value.has(e.from.id)&&m.value.has(e.to.id)}])},null,10,ot)),64)),g(" Nodes "),(r(),o(O,null,z(n,e=>t("g",{key:e.id,class:C(D(e))},[t("circle",{cx:e.x,cy:e.y,r:"18"},null,8,it),t("text",{x:e.x,y:e.y+1,"text-anchor":"middle","dominant-baseline":"middle","font-size":"12","font-weight":"700"}," F("+h(e.value)+") ",9,ut),m.value.has(e.id)?(r(),o("text",{key:0,x:e.x,y:e.y+30,"text-anchor":"middle","font-size":"11","font-weight":"600",fill:"var(--dsa-green)"}," = "+h(e.result),9,ct)):g("v-if",!0)],2)),64))],12,rt))]),c.value&&p.value.size>0?(r(),o("div",mt,[a[3]||(a[3]=t("span",{class:"rt-memo-label"},"メモ:",-1)),(r(!0),o(O,null,z([...p.value].sort((e,l)=>e[0]-l[0]),([e,l])=>(r(),o("span",{key:e,class:"rt-memo-entry"}," F("+h(e)+")="+h(l),1))),128))])):g("v-if",!0)]))}}),pt=Y(ht,[["__scopeId","data-v-7ac095b7"]]),yt={__name:"slides.md__slidev_14",setup(F){const{$clicksContext:M,$frontmatter:v}=S();return M.setup(),(x,u)=>{const f=pt;return r(),A(Z,K(Q(b(U)(b(v),13))),{default:G(()=>[u[0]||(u[0]=t("h2",null,"再帰木で理解するメモ化の効果",-1)),J(f),u[1]||(u[1]=t("ul",null,[t("li",null,[t("span",{class:"katex"},[t("span",{class:"katex-mathml"},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("semantics",null,[t("mrow",null,[t("mi",null,"F"),t("mo",{stretchy:"false"},"("),t("mn",null,"5"),t("mo",{stretchy:"false"},")")]),t("annotation",{encoding:"application/x-tex"},"F(5)")])])]),t("span",{class:"katex-html","aria-hidden":"true"},[t("span",{class:"base"},[t("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),t("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"F"),t("span",{class:"mopen"},"("),t("span",{class:"mord"},"5"),t("span",{class:"mclose"},")")])])]),i(" の再帰木を見てみましょう．同じ部分問題（オレンジの点線）が何度も計算されている")]),t("li",null,[t("strong",null,"メモ化ON"),i("にすると，一度計算した結果（紫）を再利用 → 呼び出し回数が"),t("strong",null,"15回→9回"),i("に激減")]),t("li",null,[i("これが "),t("span",{class:"katex"},[t("span",{class:"katex-mathml"},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("semantics",null,[t("mrow",null,[t("mi",{mathvariant:"normal"},"O"),t("mo",{stretchy:"false"},"("),t("msup",null,[t("mn",null,"2"),t("mi",null,"N")]),t("mo",{stretchy:"false"},")")]),t("annotation",{encoding:"application/x-tex"},"\\mathrm{O}(2^N)")])])]),t("span",{class:"katex-html","aria-hidden":"true"},[t("span",{class:"base"},[t("span",{class:"strut",style:{height:"1.0913em","vertical-align":"-0.25em"}}),t("span",{class:"mord mathrm"},"O"),t("span",{class:"mopen"},"("),t("span",{class:"mord"},[t("span",{class:"mord"},"2"),t("span",{class:"msupsub"},[t("span",{class:"vlist-t"},[t("span",{class:"vlist-r"},[t("span",{class:"vlist",style:{height:"0.8413em"}},[t("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[t("span",{class:"pstrut",style:{height:"2.7em"}}),t("span",{class:"sizing reset-size6 size3 mtight"},[t("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.10903em"}},"N")])])])])])])]),t("span",{class:"mclose"},")")])])]),i(" → "),t("span",{class:"katex"},[t("span",{class:"katex-mathml"},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("semantics",null,[t("mrow",null,[t("mi",{mathvariant:"normal"},"O"),t("mo",{stretchy:"false"},"("),t("mi",null,"N"),t("mo",{stretchy:"false"},")")]),t("annotation",{encoding:"application/x-tex"},"\\mathrm{O}(N)")])])]),t("span",{class:"katex-html","aria-hidden":"true"},[t("span",{class:"base"},[t("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),t("span",{class:"mord mathrm"},"O"),t("span",{class:"mopen"},"("),t("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N"),t("span",{class:"mclose"},")")])])]),i(" の改善の正体 ― 重複する枝がすべて刈り取られる")])],-1))]),_:1},16)}}};export{yt as default};
